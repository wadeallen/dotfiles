#!/usr/bin/env python3

from os.path import expanduser
import os
import os.path
import subprocess
from urllib.request import urlopen
from slugify import slugify
from titlecase import titlecase
from pick import pick

home = expanduser("~")

name = input('Name of the ministry: ')
area_question = 'Name of primary ministry area: '
area_options = ['None', 'Children', 'Youth', 'Adult', 'Property', 'Outreach', 'Member Care', 'Worship']

area = pick(area_options, area_question)
area = area[0]

month_question = 'What month do we need to begin to prepare for this ministry? '
month_options = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December']

month = pick(month_options, month_question)
month = month[0]


slug = slugify(name)

filename =(home + '/Sites/fbc-wiki/_ministries/' + slug + '.md' )

target = open (filename, 'w')
target.write("---\ntitle: {}\narea: {}\nbegin_month: {}\n---\n\n".format(titlecase(name), area, month))
target.close()
subprocess.call(['nvim', '+6', '-c', 'call AutoCorrect()', filename])

