#!/usr/bin/env python3

import sys
import subprocess
import webbrowser

import requests
from datetime import date, timedelta, datetime
import calendar
from dateutil.relativedelta import relativedelta

date_format = '%Y%m%d'
today = date.today()
next_month = today + relativedelta(months=1)
beg = today

def first_day_month(d):
    return date(d.year, d.month, 1)

first_day=first_day_month(next_month)
first_next_month=first_day.strftime(date_format)

def last_day_month(date):
	last_day_month = date.replace(day = calendar.monthrange(date.year, date.month)[1])
	return last_day_month.strftime(date_format)

end = beg + relativedelta(months=2)
begin_date = first_next_month
end_date = last_day_month(end)

format = "%B"
cal_format = "%Y-%m-%d"

n_month = next_month.strftime(format)
second_month = today + relativedelta(months=2)
s_month = second_month.strftime(format)

email_address = 'cct@fbcmuncie.org'

subject = 'CCT Calendar for {} and {}'.format(n_month, s_month)
message = ('Hello Team %0A%0A' \
        'Would you please take a few minutes and review the church calendar for {} and {}? You can access the calendar at:%0A%0Ahttps://fbcmuncie.churchcenter.com/calendar%0A%0ALet me know if there are mistakes or additions. If you see any potential conflicts on the schedule, I would appreciate you letting me know so that we can work out the conflicts. Also, if you have a Visitor article for any of these events, please email it to me before the next deadline. %0A%0AHave a great week, %0A%0AWade'.format(next_month.strftime(format), second_month.strftime(format)) \
	)

url = 'https://mail.google.com/mail/?view=cm&fs=1&to=' + email_address + '&su=' + subject + '&body=' + message

subprocess.call(["xdg-open", url])




