#!/usr/bin/env python3

import os
from datetime import date
from dateutil.relativedelta import relativedelta, SU
import datetime
from dateutil import parser
import csv



today = date.today()
format = '%Y-%m-%d'

this_sunday = today + relativedelta(weekday=SU(+1))
this_sunday = this_sunday.strftime(format)

next_sunday = today + relativedelta(weekday=SU(+2))
next_sunday = next_sunday.strftime(format)

with open('/home/wadeallen/Sites/fbcmuncie_2018/_data/youth.csv') as csvfile:
    readCSV = csv.reader(csvfile, delimiter=',')
    for row in readCSV:
        if row[0] == this_sunday:
            thisweek = row
            thissun = datetime.datetime.strptime(thisweek[0], '%Y-%m-%d')
            thissun = thissun.strftime('%b %d')
        if row[0] == next_sunday:
            nextweek = row
            nextsun = datetime.datetime.strptime(thisweek[0], '%Y-%m-%d')
            nextsun = nextsun.strftime('%b %d')

# check for fifth sunday
if thisweek[1] == 'yes':
    announcement = f'is Fellowship of the Fifth.\nTime: {thisweek[2]}\nDescription: {row[3]}'
# check for sunday school
elif thisweek[4] == 'yes':
    announcement = f'Sunday school will be led by {thisweek[5]}.'
# check if not fifth sunday and no sunday school
elif thisweek[1] == 'no' and thisweek[4] == 'no':
    announcement = f'there is no Sunday School.'

print(f'This week,{thissun}, {announcement}')
print(nextweek)





# target = open ('/home/wadeallen/Dropbox/Pandoc/Pandoc_Bulletin/includes/youth.tex', 'w')
# # target.write ('\def\sundaydate{' + postdate.strftime('%b %d, %Y') + '}\n\def\sermontitle{' + post['title'] + '}\n\def\scripture{' + post['scripture'] + '}\n\input{../numbers}\n')
# target.write('\subsection{Youth Ministry Update}\n')
# target.write('\label{youthministryudpate}\n\n')
# target.write('Next Sunday, ' + today.strftime('%B %d') + ', we will be ...')
# target.close()

