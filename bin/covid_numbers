#!/usr/bin/env python3

from requests import get
import config
import json	
import datetime

day = datetime.date.today()

today = day - datetime.timedelta(days=1)
yesterday = day - datetime.timedelta(days=2)
three_day = day - datetime.timedelta(days=3)
four_day = day - datetime.timedelta(days=4)

y = yesterday.strftime('%Y%m%d')
t = today.strftime('%Y%m%d')
three = three_day.strftime('%Y%m%d')
four = four_day.strftime('%Y%m%d')

y_date = yesterday.strftime('%b %d')
t_date = today.strftime('%b %d')
threedate = three_day.strftime('%b %d')
fourdate = four_day.strftime('%b %d')

y_covid_in = f"https://api.covidtracking.com/v1/states/in/{y}.json"
y_covid_response = get(y_covid_in)
y_covid_data = json.loads(y_covid_response.text)


t_covid_in = f"https://api.covidtracking.com/v1/states/in/{t}.json"
t_covid_response = get(t_covid_in)
t_covid_data = json.loads(t_covid_response.text)

threecovid_in = f"https://api.covidtracking.com/v1/states/in/{three}.json"
threecovid_response = get(threecovid_in)
threecovid_data = json.loads(threecovid_response.text)

fourcovid_in = f"https://api.covidtracking.com/v1/states/in/{four}.json"
fourcovid_response = get(fourcovid_in)
fourcovid_data = json.loads(fourcovid_response.text)

time = datetime.datetime.now().time()
time_format = int(time.strftime('%H%m'))

if time_format < 1200:
    print(f"{fourdate}:\t{fourcovid_data['positiveIncrease']}")
    print(f"{threedate}:\t{threecovid_data['positiveIncrease']}")
    print(f"{y_date}:\t{y_covid_data['positiveIncrease']}")
else:
    print(f"{fourdate}:\t{fourcovid_data['positiveIncrease']}")
    print(f"{threedate}:\t{threecovid_data['positiveIncrease']}")
    print(f"{y_date}:\t{y_covid_data['positiveIncrease']}")
    print(f"{t_date}:\t{t_covid_data['positiveIncrease']}")

