#!/bin/bash

source /home/wadeallen/Dropbox/Config\ Files/config.sh

# Get hostname from computer
host=`hostname`

# Get internet connection device
if [ ${host} == "wade-laptop" ];
then
	local_ip=$(ip -4 -o addr show dev wlp3s0 | awk '{split($4,a,"/");print a[1]}')
fi

if [ ${host} == "wade-desktop" ];
then
	local_ip=$(ip -4 -o addr show dev enp0s25 | awk '{split($4,a,"/");print a[1]}')
fi

# Check if at church on laptop
if [ ${local_ip} == "192.168.86.41" ];

then

curl -X POST -H "Authorization: Bearer ${church}" \
  -H "Content-Type: application/json" \
  -d '{"entity_id": "switch.pastor_lamp_relay"}' \
  https://church.wadeallen.me/api/services/switch/toggle

fi

# Check if at church on desktop
if [ ${local_ip} == "192.168.1.151" ];

then

curl -X POST -H "Authorization: Bearer ${church}" \
  -H "Content-Type: application/json" \
  -d '{"entity_id": "switch.pastor_lamp_relay"}' \
  https://church.wadeallen.me/api/services/switch/toggle

fi

# Check if at home on laptop

echo "${local_ip} and ${host}" 
